(self["webpackChunksee_you_then"]=self["webpackChunksee_you_then"]||[]).push([[219],{6710:(e,t,a)=>{"use strict";a.d(t,{X:()=>l});var n=a(1959);const l=(0,n.iH)(null)},2258:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>X});var n=a(3673),l=a(2323);const o=(0,n._)("div",{class:"text-h6"},"Create Time Slot",-1),i=(0,n.Uk)(" Share this "),r=(0,n.Uk)(" link"),u=(0,n.Uk)(" to allow people to reserve spots spots on your calendar. "),s={class:"row justify-center"},d=(0,n.Uk)(" Time Slots"),c=(0,n.Uk)(" Add a new available time slot "),m=(0,n.Uk)(" No time slots for this day ");function p(e,t,a,p,f,h){const w=(0,n.up)("q-card-section"),g=(0,n.up)("q-input"),y=(0,n.up)("q-btn"),b=(0,n.up)("q-card-actions"),v=(0,n.up)("q-card"),k=(0,n.up)("q-dialog"),S=(0,n.up)("router-link"),D=(0,n.up)("q-date"),W=(0,n.up)("q-item-label"),_=(0,n.up)("q-item-section"),T=(0,n.up)("q-tooltip"),q=(0,n.up)("q-item"),Z=(0,n.up)("q-separator"),I=(0,n.up)("q-list"),Y=(0,n.up)("q-page"),U=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(Y,{class:"column justify-center items-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{modelValue:e.showAddTimeSlotDialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.showAddTimeSlotDialog=t)},{default:(0,n.w5)((()=>[(0,n.Wm)(v,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w,null,{default:(0,n.w5)((()=>[o])),_:1}),(0,n.Wm)(w,{class:"q-pt-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{class:"q-ma-md",modelValue:e.addTimeSlotStartTime,"onUpdate:modelValue":t[0]||(t[0]=t=>e.addTimeSlotStartTime=t),filled:"",type:"time",label:"Start Time","stack-label":""},null,8,["modelValue"]),(0,n.Wm)(g,{class:"q-ma-md",modelValue:e.addTimeSlotEndTime,"onUpdate:modelValue":t[1]||(t[1]=t=>e.addTimeSlotEndTime=t),filled:"",type:"time",label:"End Time","stack-label":""},null,8,["modelValue"])])),_:1}),(0,n.Wm)(b,{align:"right"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n.Wm)(y,{flat:"",label:"Add Time Slot",icon:"add",color:"primary",onClick:e.addTimeSlotButton},null,8,["onClick"]),[[U]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),"index"==e.$route.name?((0,n.wg)(),(0,n.j4)(v,{key:0,class:"text-center q-pa-md q-ma-md"},{default:(0,n.w5)((()=>[i,(0,n.Wm)(S,{to:{name:"schedule",params:{id:e.calendarPubkey?e.calendarPubkey.toString():""}}},{default:(0,n.w5)((()=>[r])),_:1},8,["to"]),u])),_:1})):((0,n.wg)(),(0,n.j4)(v,{key:1,class:"text-center q-pa-md q-ma-md"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Schedule a meeting with "+(0,l.zw)(e.calendarPubkey?e.calendarPubkey.toString():""),1)])),_:1})),(0,n._)("div",s,[(0,n.Wm)(D,{modelValue:e.selectedDateString,"onUpdate:modelValue":t[3]||(t[3]=t=>e.selectedDateString=t),landscape:"",class:"q-ma-md",events:e.calendarEventsHighlighter},null,8,["modelValue","events"]),(0,n.Wm)(I,{bordered:"",separator:""},{default:(0,n.w5)((()=>[(0,n.Wm)(q,null,{default:(0,n.w5)((()=>[(0,n.Wm)(_,null,{default:(0,n.w5)((()=>[(0,n.Wm)(W,{class:"text-h5"},{default:(0,n.w5)((()=>[d])),_:1})])),_:1}),(0,n.Wm)(_,{avatar:""},{default:(0,n.w5)((()=>["index"==e.$route.name?((0,n.wg)(),(0,n.j4)(y,{key:0,icon:"add",color:"primary",round:"",onClick:t[4]||(t[4]=t=>e.showAddTimeSlotDialog=!0)},{default:(0,n.w5)((()=>[(0,n.Wm)(T,null,{default:(0,n.w5)((()=>[c])),_:1})])),_:1})):(0,n.kq)("",!0)])),_:1})])),_:1}),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.currentDayTimeSlots,(t=>((0,n.wg)(),(0,n.j4)(q,{key:t.id,clickable:"schedule"==e.$route.name,onClick:a=>e.scheduleMeetingButton(t)},{default:(0,n.w5)((()=>[(0,n.Wm)(_,null,{default:(0,n.w5)((()=>[(0,n.Wm)(W,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.format_time(t.time.start))+" - "+(0,l.zw)(e.format_time(t.time.end)),1)])),_:2},1024),(0,n.Wm)(W,{caption:""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(t.scheduledWith?`Scheduled with ${e.format_pubkey(t.scheduledWith)}`:"Open"),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["clickable","onClick"])))),128)),0==e.currentDayTimeSlots.length?((0,n.wg)(),(0,n.j4)(q,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(_,null,{default:(0,n.w5)((()=>[(0,n.Wm)(W,{caption:""},{default:(0,n.w5)((()=>[m])),_:1})])),_:1})])),_:1})):(0,n.kq)("",!0),(0,n.Wm)(Z)])),_:1})])])),_:1})}var f=a(1959),h=a(9582),w=a(8051);const g="https://api.devnet.solana.com",y=new w.ew(g,"confirmed");var b=a(4244),v=a(4434),k=a(6710),S=function(e,t,a,n){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function i(e){try{u(n.next(e))}catch(t){o(t)}}function r(e){try{u(n["throw"](e))}catch(t){o(t)}}function u(e){e.done?a(e.value):l(e.value).then(i,r)}u((n=n.apply(e,t||[])).next())}))};const D=new w.nh("F1EdFSDRttLzmcKvwkF6VTL4fSyDTyo3xx68kxSCdSwE");function W(e,t,a){return S(this,void 0,void 0,(function*(){a&&""!=a||(a=btoa(Math.random().toString()));const n=k.X.value;if(!n||!n.adapter.publicKey)return void v.Z.create({type:"negative",message:"Could not create time slot: wallet not connected"});const l=new w.nh(n.adapter.publicKey.toString());yield y.requestAirdrop(l,w.j5);const o=new w.RG,i=new w.YW({feePayer:l,recentBlockhash:(yield y.getRecentBlockhash()).blockhash}),r=e.valueOf()/1e3,u=t.valueOf()/1e3,s=b.Buffer.byteLength(a),d=b.Buffer.alloc(21+s);let c=0;c=d.writeUInt8(0,c),c=d.writeDoubleLE(r,c),c=d.writeDoubleLE(u,c),c=d.writeUInt32LE(s,c),d.write(a,c),i.add(new w.Sl({programId:D,keys:[{pubkey:l,isWritable:!0,isSigner:!0},{pubkey:o.publicKey,isWritable:!0,isSigner:!0},{pubkey:w.yc.programId,isWritable:!0,isSigner:!1}],data:d})),i.sign(o);const m=yield n.adapter.sendTransaction(i,y);console.log("Completed transaction",m)}))}function _(e,t){return S(this,void 0,void 0,(function*(){const a=k.X.value;if(!a||!a.adapter.publicKey)return void v.Z.create({type:"negative",message:"Could not create time slot: wallet not connected"});const n=new w.nh(a.adapter.publicKey.toString());yield y.requestAirdrop(n,w.j5);const l=new w.RG,o=new w.YW({feePayer:n,recentBlockhash:(yield y.getRecentBlockhash()).blockhash}),i=b.Buffer.byteLength(t),r=b.Buffer.alloc(5+i);let u=0;u=r.writeUInt8(1,u),u=r.writeUInt32LE(i,u),r.write(t,u),o.add(new w.Sl({programId:D,keys:[{pubkey:n,isWritable:!0,isSigner:!0},{pubkey:l.publicKey,isWritable:!0,isSigner:!0},{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:w.yc.programId,isWritable:!0,isSigner:!1}],data:r})),o.sign(l);const s=yield a.adapter.sendTransaction(o,y);console.log("Completed transaction",s),v.Z.create({type:"positive",message:"Successfully scheduled meeting! ðŸŽ‰"})}))}function T(e){return S(this,void 0,void 0,(function*(){const t=[],a=yield y.getProgramAccounts(D,{filters:[{memcmp:{offset:0,bytes:e.toBase58()}}]});for(const e of a)t.push(Z(e.pubkey,e.account.data));return t}))}function q(e,t){const a=y.onProgramAccountChange(D,(e=>{t(Z(e.accountId,e.accountInfo.data))}),"confirmed",[{memcmp:{offset:0,bytes:e.toBase58()}}]);return a}function Z(e,t){let a=0;const n=e=>(a+=e,e),l=t.subarray(a,n(32)),o=new w.nh(l),i=new Date(1e3*t.readDoubleLE(a));n(8);const r=new Date(1e3*t.readDoubleLE(a));n(8);const u=1==t.readUInt8(a);n(1);const s=t.subarray(a,a+n(32)),d=new w.nh(s),c=t.readUInt32LE(a);n(4);const m=t.subarray(a,a+c),p=m.toString();return{id:e,meetingId:p,owner:o,time:{start:i,end:r},scheduledWith:u?d:void 0}}var I=a(2661),Y=a(8825),U=function(e,t,a,n){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function i(e){try{u(n.next(e))}catch(t){o(t)}}function r(e){try{u(n["throw"](e))}catch(t){o(t)}}function u(e){e.done?a(e.value):l(e.value).then(i,r)}u((n=n.apply(e,t||[])).next())}))};function C(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}const P=(0,n.aZ)({name:"Index",components:{},setup(){var e;const t=(0,h.yj)(),a=(0,Y.Z)(),l="schedule"==t.name?new w.nh(t.params.id):null===(e=k.X.value)||void 0===e?void 0:e.adapter.publicKey,o=new Date(Date.now()),i=(0,f.iH)(I.ZP.formatDate(o,"YYYY/MM/DD")),r=(0,f.iH)(!1),u=(0,f.iH)(""),s=(0,f.iH)(""),d=(0,f.iH)([]),c=(0,f.Fl)((()=>d.value.filter((e=>C(m.value,e.time.start))).sort(((e,t)=>e.time.start.valueOf()-t.time.start.valueOf()))));(0,n.YP)(c,(e=>{console.log(e.map((e=>e.id.toString()))),console.log(e.map((e=>e.scheduledWith?e.scheduledWith.toString():"null")))}));const m=(0,f.Fl)((()=>new Date(Date.parse(i.value))));return l&&(T(l).then((e=>{d.value=e})),q(l,(e=>{const t=d.value.filter((t=>!t.id.equals(e.id)));t.push(e),d.value=t}))),{showAddTimeSlotDialog:r,selectedDateString:i,currentDayTimeSlots:c,addTimeSlotStartTime:u,addTimeSlotEndTime:s,$route:t,calendarPubkey:l,addTimeSlotButton(){return U(this,void 0,void 0,(function*(){const e=new Date(Date.parse(i.value));e.setHours(Number.parseInt(u.value.split(":")[0])),e.setMinutes(Number.parseInt(u.value.split(":")[1]));const t=new Date(Date.parse(i.value));t.setHours(Number.parseInt(s.value.split(":")[0])),t.setMinutes(Number.parseInt(s.value.split(":")[1])),console.log({start:I.ZP.formatDate(e,"YYYY/MM/DD hh:mm A"),end:I.ZP.formatDate(t,"YYYY/MM/DD hh:mm A")}),yield W(e,t),u.value="",s.value=""}))},scheduleMeetingButton(e){"schedule"==t.name&&l&&a.dialog({title:"Confirm",message:`Would you like to schedule a meeting           with this user at ${I.ZP.formatDate(e.time.start,"YYYY/MM/DD hh:mm A")}?`,cancel:!0}).onOk((()=>{_(e.id,"TodoUseUsername")}))},format_time(e){return I.ZP.formatDate(e,"hh:mm A")},format_pubkey(e){let t=e.toString();return t.substr(0,4)+"..."+t.substring(t.length-4,t.length)},calendarEventsHighlighter(e){const t=new Date(Date.parse(e));return d.value.reduce(((e,a)=>C(t,a.time.start)||e),!1)}}}});var A=a(4379),B=a(1573),E=a(151),M=a(5589),Q=a(1206),x=a(9367),L=a(8240),V=a(1860),j=a(7011),H=a(3414),K=a(2035),F=a(2350),O=a(2406),$=a(5869),z=a(677),N=a(7518),R=a.n(N);P.render=p;const X=P;R()(P,"components",{QPage:A.Z,QDialog:B.Z,QCard:E.Z,QCardSection:M.Z,QInput:Q.Z,QCardActions:x.Z,QBtn:L.Z,QDate:V.Z,QList:j.Z,QItem:H.Z,QItemSection:K.Z,QItemLabel:F.Z,QTooltip:O.Z,QSeparator:$.Z}),R()(P,"directives",{ClosePopup:z.Z})},6601:()=>{},9214:()=>{},5568:()=>{},5024:()=>{}}]);